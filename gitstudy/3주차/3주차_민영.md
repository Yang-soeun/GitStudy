# CHAPTER06. 더욱 세심하게 커밋하기
## LESSON20. 프로답게 커밋하기

### 커밋 권장 사항과 커밋 메시지 컨벤션
문제가 발생했을 경우 코드 변경 사항을 추적해서 이전 상태로 쉽게 돌아갈 수 있기 때문에 보통 하나의 커밋에는 한 단위의 작업을 넣음
커밋 메시지는 변경사항의 내용과 의도를 명확하게 표현해야 함
컨벤션에 따라 커밋 메시지를 작성하는 것이 좋음
컨벤션은 개발 팀원들끼리 일관된 방식으로 커밋 메시지를 작성하여 프로젝트의 품질과 유지 보수성을 높이기 위한 규칙을 말함
컨벤션은 보편적으로 정해진 규칙이 아니라 팀의 업무에 맞춰 팀원들이 합의한 것

> TYPE : SUBJECT
> 
> BODY(OPTIONAL)  
>
>
> FOOTER(OPTIONAL)

```
FEAT: 압축 파일 미리보기 기능 추가  
사용자 편의를 위해 압축 어쩌구  
-어쩌구 클릭  
-저쩌구 클릭  

CLOSES #이슈번호
```
|타입|설명|
|--|--|
|FEAT|새로운 기능 추가|
|FIX|버그 수정|
|DOCS|문서 수정|
|STYLE|공백, 세미콜론 등 스타일 수정|
|REFACTOR|코드 리팩토링|
|PERF|성능 개선|
|TEST|테스트 추가|
|CHORE|빌드 과정 또는 보조 기능(문서 생성 기능등)수정|

타입 다음에는 서브젝트를 덧붙일 수 있음-이 커밋에서 뭘 하는 건지를 여기서 간략히 적는 것  
타입과 서브젝트 다음에 한줄 비우고 상세내용을 적고 푸터가 필요한 경우에는 역시 한줄 비우고 그 아래 내용을 적음  
푸터에는 중요한 변경 지점이 있을때 적거나 특정 이슈에 대한 해결 작업일 떄 이슈 번호를 적는 식으로 사용함  

### 변경 사항을 확인하며 헝크 단위로 스테이징하기
변경사항이 다소 복잡하다면 프로제트에 더한 변경사항이 무엇인지 차근차근 확인해 보고싶을때 헝크라는 덩어리로 나워서 살펴봄  
헝크란 하나의 파일에서 수정된 코드 블록의 일부  
깃에서 파일을 커밋할 떄는 헝크 단위로커밋 메시지를 작성해야 수정된 부분을 더욱 쉽게 구분할 수 있음  

1. 변경 사항을 모두 git add하고 커밋하기 전에 하나하나 헝크 단위로 확인 하기 위해 git add명령어 뒤에 -p(patch)옵션을 붙임  
> git add -p

2. 다음과 같은 모드에 헝크별로 변경사항이 나타나며 각 헝크의 변경 여부를 받아들일지 물어봄  
   받아들이려면 y  
   그대로 두려면 n  
   이런식으로 같은 파일에서 부분별로 add를 할 수 있음
   
   <img width="614" alt="스크린샷 2024-07-02 213910" src="https://github.com/nyeongha/systudy1/assets/49603260/174d1007-051d-458a-8974-2bb24625510c">
   
변경된 부분 사이에 변경되지 않은 부분이 있기 떄문에 위 아래 두 코드는 별개의 헝크로 인식

### [y,n,q,s,e]옵션의 기능
y- 이 헝크를 스테이지 영역으로 add  
n- 이 헝크를 스테이지 영역으로 add 하지 않음  
q- add종료  
s- 현재의 헝크를 더 작은 단위의 헝크로 나눔  
e- 현재의 헝크를 수동으로 편집  

3. git status로 상태를 확인해보면 두 파일 다 부분적으로만 add되었기 때문에 add가 된부분과 add되지 않은 부분에 모두 표시되어 있음  
   
<img width="414" alt="스크린샷 2024-07-02 215105" src="https://github.com/nyeongha/systudy1/assets/49603260/f762a4de-e8aa-4659-aecf-8e3d023b3b99">

4. 어떤 변경사항이 반영되었는지 확인하려면 git commit 명령어 뒤에 -v옵션을 붙임  
> git commit -v

5. 커밋 메시지를 입력하라는 내용과 변경사항이 나타나면 커밋 메시지를 입력하고 저장  
   
<img width="643" alt="스크린샷 2024-07-02 220024" src="https://github.com/nyeongha/systudy1/assets/49603260/dfbb9c6e-45da-483a-9f7f-cb6a485e7cc7">

6. 커밋 완료  

<img width="305" alt="스크린샷 2024-07-02 220207" src="https://github.com/nyeongha/systudy1/assets/49603260/a4bb5c15-348d-4f6a-b4ba-fceb401976e6">

### 스태시로 작업하던 내용 잠시 치워 두기  
스태시란 작업하던 내용을 깃에서 다른 공간에 잠시 치워 두는 기능  

1. 스태시를 하려면 먼저 깃의 관리대상(tracked)이 되어야 함  
> git add tomcats.yaml  

2. 파일이 업데이트 된 상태에서 git stash명령을 실행  
<img width="500" alt="스크린샷 2024-07-02 221447" src="https://github.com/nyeongha/systudy1/assets/49603260/22f24786-aa95-412b-9487-220cc9ca5819">  

> git stash 명령 뒤에는 원래 save옵션을 붙이지만 git stash save대신 그냥 git stash만 입력해도 동일하게 변경사항이 스태시로 치워짐  

3. 앞의 변경사항이 어디로 갔는지 확인하기 위해 소스트리에서 왼쪽 메뉴의 스태시를 클릭하고 해시값을 클릭->변경사항 내용이 나타남  
4. 현재 작업중이던 내용이 스태시 영역에 보관되어 있으므로 다른 브랜치에서 작업을 한 뒤 언제든 다시 적용할 수 있음  
5. main으로 브랜치 변경후 git stash pop을 입력  
6. 스태시했던 변경 사항들이 표시됨  

### 원하는 변경 사항만 스태시하기  
현재 작업 중이던 깃을 스태시 하려면 git stash명령을 사용  
git stash명령뒤에 다음과 같은 옵션을 붙이면 스태시를 더욱 다채롭게 활용할 수 있음  

|명령어|설명|비고|
|--|--|--|
|git stash|현 작업들 치워 두기|끝에 save 생략|
|git stash apply|치워 둔 마지막 항목(번호 없을 시) 적용| 끝에 번호로 항목 지정 가능|
|git stash drop|치워 둔 마지막 항목(번호 없을 시) 삭제|끝에 번호로 항목 지정 가능|
|git stash pop|치워 둔 마지막 항목(번호 없을 시) 적용 및 삭제|apply+drop|
|git stash branch(브랜치 이름)|새 브랜치 생성하여 pop|충돌 사항이 있는 상황에 유용|
|git stash clear|치워둔 모둔 항목들 비우기||

git stash pop 과 git stash apply는 모두 치워둔 작업을 가져오는 명령  
둘의 차이점은 스태시 기록의 삭제 유무  

1. 각각의 파일에 내용을 추가하고 저장
2. 두 파일의 변경 사항중 원하는 부분만 골라서 스태시할 수 있음
> git stash -p

3. 맨 마지막에 수정한 내역부터 반영여부를 물어봄.
4. y를 누르면 파일에서 수정한 내역이 삭제됨
5. n을 누르면 그대로 남음
6. n을 눌렀던 파일도 다시 스태시 하기위해 어떤 부분을 치워 둔 건지 알수있게 git stash -m '커밋메시지'명령을 실행
7. n을 눌렀던 파일도 스태시 처리됨
8. 치워둔 스태시 목록을 확인하려면 git stash 명령어 뒤에 list를 붙임
<img width="376" alt="스크린샷 2024-07-02 223818" src="https://github.com/nyeongha/systudy1/assets/49603260/3f4b52a0-7d86-450f-9bb8-2d5b25950f22">

9. 스태시를 적용한다는 것은 커밋한다는 뜻이 아니라 파일을 그 상태로 저장하고, add나 커밋 등 원하는 작업을 할 수있게 파일을 다시 수정된 상태로 돌려 놓는 다는 의미  
10. git stash 명령뒤에 apply 옵션을 붙이고 원하는 스태시 항목을 입력  
> 윈도우에서는 ' ' 로 감싸줘야
> git stash apply 'stash@{0}'

11. 스태시를 지울때는 git stash 명령에 drop옵션을 붙여서 활용
> git stash drop 'stash@{0}' 
<img width="380" alt="스크린샷 2024-07-02 224536" src="https://github.com/nyeongha/systudy1/assets/49603260/010c709f-b555-44c7-ab4b-8dc709f44f48">

12. 스태시를 활용할 떄 git stash apply로 코드에 적용하고 git stash drop으로 스태시 목록에서 지우는 작업을 한번에 하려면 git stash pop명령을 활용, git stash list명령으로 목록을 확인하면 스태시가 비어있음
13. git stash pop 명령을 적용할 떄 기존 브랜치가 아닌 새로운 브랜치에 적용하려면 git stash branch명령을 사용
14. 다른 작업을 하고있는 중에 스태시를 pop해서 가져오면 충돌이 발생할 수 있으니 스태시에 있던 변경 사항을 다른 브랜치로 가져갔다가 충돌이 날 만한것들을 해결한 뒤에 병합
15. 파일에 내용을 추가하고 저장한뒤 스태시 적용후 stash-branch라는 새 브랜치 추가

<img width="870" alt="스크린샷 2024-07-03 00 24 46" src="https://github.com/nyeongha/systudy1/assets/49603260/94cd93ea-77c1-416d-a115-54c3d5714904">

### 마지막 커밋 수정하기
아래 명령을 실행하면 커밋 메시지를 수정할 수 있는 창이 열림
> git commit --amend

git commit --amend명령뒤에 -m옵션을 붙이고 수정할 커밋 메시지를 바로 입력
> git commit --amend -m '수정할 커밋 메시지'

### 과거의 커밋을 수정 삭제 병합 분할
기본적으로 깃은 모든 커밋 내역이 순차적으로 저장  
깃에서 과거에 어떤 내역이 변경되면 그다음에 이루어지는 변경사항은 이전과는 다른 커밋  
깃에서 과거에 어떤내역을 수정하기 위해서는 그것만 수정하는게 아니라 수정한 커밋부터 이후까지 새로운 브랜치를 만든 다음에 기존 작업에 리베이스로 갖다 붙이는 방식으로 과거를 바꿔버림  

|명령어|설명|
|--|--|
|p,pick|커밋 그대로 두기|
|r,reword|커밋 메시지 변경|
|e,edit|수정을 위해 정지|
|d,drop|커밋 삭제|
|s,squash|이전 커밋에 합치기|

> git rebase -i 삭제하려는 커밋내역의 이전 커밋 해시값을 대입하면 에디터가 나오고 삭제하려는 부분에 pick을 지우고 d를 넣고 저장하면 삭제됨

## Lesson21. 취소와 되돌리기 더 깊이 알기

### 관리되지 않는 파일들 삭제하기
git clean명령을 이용해 깃에서 아직 추적하지 않는 파일들을 삭제하는 방법
|옵션|설면|
|-n|삭제될 파일 보여주기|
|-i|인터랙티브 모드 시작하기|
|-d|폴더 포함하기|
|-f|강제로 지워버리기|
|-x|.gitignore에 등록된 파일 삭제하기(주의)|

### restore로 커밋하지 않은 변경 사항 되돌리기
git checkout이 git switch와 git restore로 분리됨
git restore명령을 이용하여 특정 파일을 작업 디렉터리나 스테이지에서 되돌려 놓을 수 있음

### 리셋 취소하기
git reset --hard명령을 사용하면 해당 커밋이 작업 내역에서 완전히 삭제됨
git log를 실행해도 커밋 내역이 나타나지 않음
리셋으로 삭제한 커밋을 복원하려면 git reflog명령을 사용
> git reflog

git reflog명령을 실행하면 내가 수행한 깃 작업의 모든 내역이 나타남
> git reset --hard (이전 커밋 해시값)
이렇게 하면 리셋으로 삭제한 커밋도 다시 복원이 가능함

## Lesson22. 커밋에 태그 달기
깃의 각 커밋에는 별명처럼 태그를 붙일 수 있음
### 프로그램의 버전

메이저: 프로그램 이전 버전에서 호환되지않을 정도로 큰 변화나 업그레이드
마이너: 새로운 기능이 추가되거나 기존 기능이 변경되는 정도를 나타냄
패치: 버그 등 작은 문제를 수정한 것

태그  
- lightweight: 특정 커밋에 붙여서 태그 이름으로 지칭  
- annotated: 작성자의 이름, 이메일,날짜, 커밋메시지,GPG설명등을 기입할 수 있음  
- 필요에 맞게 쓰되 기왕 태그를 단다면 annotated로 달기를 추천  

### 마지막 커밋에 태그달기
소스트리: 태그달 커밋을 선택하고 우클릭->태그 선택->태그 추가
cli: git tag 태그내용 입력->특정 커밋을 지정하지 않으면 마지막 커밋에 태그가 달림
cli에 현존하는 태그를 확인하려면 git tag명령을 입력
특정한 태그를 붙인 커밋의 변경사항을 확인하려면 git show 명령을 입력하고 태그를 붙임
> git show 태그
태그를 삭제하려면 git tag 명령뒤에 -d를 붙이고 태그 이름을 입력
> git tag -d 태그이름
annotated방식으로 태그를 달려면 git tag명령뒤에 -a를 붙이고 태그 이름 입력->입력창이 열리면 내용입력하고 저장
> git tag -a 태그

### 원하는 커밋에 태그달기
> git tag (태그이름) (커밋 해시값) -m (태그 메시지)

태그중에서 내가 원한느 태그를 필터링 하려면 와일드 카드를 이용
v1으로 시작하는 태그를 보려면 'v1.*'입력
> git tag -l 'v1.*'
태그중에서 .0으로 끝나는 태그만 필터링 하려면 git tag -l 다음에 '*0'입력
> git tag -l '*0'

### 태그로 체크아웃할 버전 지칭하기
태그를 사용하면 체크아웃할 번전을 지칭할 때도 편리
체크아웃은 헤드가 위치하는 임의의 브랜치로 이동하는 것
v1.2.1태그가 붙은 커밋 시점으로 이동
> git checkout v1.2.1

### 로컬의 태그를 원격 저장소와 동기화하기
특정 태그 하나를 올리려면 git push명령에 원격 저장소 이름과 태그 이름을 입력
> git push (원격 저장소 이름) (태그 이름)

원격 저장소에서 태그를 삭제하려면 git push명령에 --delete옵션을 붙여야함
> git push --delete (원격 저장소 이름) (태그 이름)

로컬 컴퓨터의 프로젝트에 있는 태그를 한번에 원격 저장소에 올릴때 git push 명령어에 --tag옵션을 붙임
> git push --tags

### 깃허브에서 파일 배포하기
깃허브에는 저장소 페이지에서 태그가 붙은 버전을 다운로드 할 수 있게 배포하는 기능이 있음
태그 중에 원하는 것을 사용자들이 바로 다운로드해서 사용할 수 있도록 배포 버전으로 출시할 수 있음
깃허브에 올려서 배포할때 따로 빌드를 하는게 아니라 방문자들이 그대로 다운로드 할 수 있는 코드나 파일을 제공할 떄 이방식을 사용

**summary**
1. 내용 확인하여 헝크별로 스테이지하기
   헝크별로 스테이지 하기: git add -p
   변경 사항 확인하고 커밋하기: git commit -v
2. 커밋하기 애매한 변화 치워두기
   변경사항 치워두기: git stash
   스태시한 변경 사항 적용하고 삭제하기: git stash pop
   스태시한 변경사항 적용하기: git stash apply
   스태시 목록 보기: git stash list
3. 커밋 수정하기
   커밋 메시지 변경하기: git commit --ammend
   커밋 메시지 한줄로 변경하기: git commit --ammend -m '내용'
4. 취소와 되돌리기 깊이 알기
   깃에서 추적하지 않는 파일 삭제하기: git clean
   작업 디렉터리의 특정 파일 복구하기: git restore
   깃 작업내역 확인하기:git reflog
5. 커밋에 태그달기
   태그 확인하기: git tag
   마지막 커밋에 태그달기: git tag (태그)
   태그 삭제하기: git tag -delete (태그)
   태그 메시지 입력하여 태그 달기: git tag(태그) -m '태그 메시지'
   원하는 태그 내용 확인하기: git show (태그)
   원하는 버전으로 체크아웃하기: git checkout (태그)
   원격 저장소에 특정 태그 하나 올리기: git push (원격저장소이름) (태그)
   로컬에 있는 태그를 원격 저장소에 한번에 올리기: git push --tags
   원격 저장소의 태그 삭제하기: git push --delete (원격 저장소 이름) (태그)
